import{h as re,i as b,T as de,l as se,K as ne,V as ue,a7 as ie,o as p,b as N,j as r,c as h,w as l,m as O,F as q,q as ce,u as pe,a as u,g as w,e as t,J as i,O as me,d as E,a8 as fe,a9 as _e,N as j,p as ye,f as ve,_ as Ve}from"./index-L-QTi-72.js";const F=g=>(ye("data-v-7de02e40"),g=g(),ve(),g),be={class:"card-header"},he=F(()=>w("span",null,"就诊人管理",-1)),we={class:"patient"},ge=F(()=>w("div",{class:"card-header"},[w("span",null,"添加就诊人")],-1)),Ce=re({__name:"index",setup(g){let v=ce(),R=pe(),C=b([]),f=b(1),x=b(),o=de({name:"",certificatesType:"",certificatesNo:"",sex:0,birthdate:"",phone:"",isMarry:0,isInsure:0,addressSelected:[],address:"",contactsName:"",contactsCertificatesType:"",contactsCertificatesNo:"",contactsPhone:""}),I=b(),M=b();se(()=>{U(),L(),v.query.type=="add"&&(f.value=0),v.query.type=="edit"&&(f.value=0)});const U=async()=>{let s=await ne();s.code==200&&(C.value=s.data)},Y=()=>{$(),f.value=0},$=()=>{Object.assign(o,{id:null,name:"",certificatesType:"",certificatesNo:"",sex:0,birthdate:"",phone:"",isMarry:0,isInsure:0,addressSelected:[],address:"",contactsName:"",contactsCertificatesType:"",contactsCertificatesNo:"",contactsPhone:""})},z=s=>{f.value=0,Object.assign(o,s)},H=()=>{U()},L=async()=>{let s=await ue();s.code==200&&(x.value=s.data)},X={lazy:!0,async lazyLoad(s,e){let m=(await fe(s.data.id||"86")).data.map(c=>({id:c.id,label:c.name,value:c.value,leaf:!c.hasChildren}));e(m)}},G=async()=>{await Promise.all([M.value.validate(),I.value.validate()]);try{await _e(o),j({type:"success",message:o.id?"修改数据成功":"添加成功"}),v.query.type?R.back():f.value=1,U(),console.log(o.addressSelected)}catch{j({type:"error",message:o.id?"修改数据失败":"添加失败"})}};ie(()=>C.value,()=>{if(v.query.type=="edit"){let s=C.value.find(e=>e.id==v.query.id);Object.assign(o,s)}});const J=(s,e,d)=>{/^[\u4E00-\u9FA5]{2,10}(·[\u4E00-\u9FA5]{2,10}){0,2}$/.test(e)?d():d(new Error("请输入正确的名字格式"))},K=(s,e,d)=>{e=="10"||e=="20"?d():d(new Error("请选择证件类型"))},Q=(s,e,d)=>{let m=/^([1-6][1-9]|50)\d{4}(18|19|20)\d{2}((0[1-9])|10|11|12)(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,c=/^([1-6][1-9]|50)\d{4}\d{2}((0[1-9])|10|11|12)(([0-2][1-9])|10|20|30|31)\d{3}$/,V=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;m.test(e)||c.test(e)||V.test(e)?d():d(new Error("请输入正确的证件号码"))},W=(s,e,d)=>{e=="1"||e=="0"?d():d(new Error("请选择用户性别"))},Z=(s,e,d)=>{/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(e)?d():d(new Error("请选择用户生日"))},B=(s,e,d)=>{/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/.test(e)?d():d(new Error("请输入正确的手机号码格式"))},ee=(s,e,d)=>{console.log(e),e=="1"||e=="0"?d():d(new Error("请选择婚姻状况"))},te=(s,e,d)=>{e=="1"||e=="0"?d():d(new Error("请选择自费或者医保"))},P=(s,e,d)=>{e.length?d():d(new Error("请填写用户地址"))},k={name:[{required:!0,validator:J}],certificatesType:[{required:!0,validator:K}],certificatesNo:[{required:!0,validator:Q}],sex:[{required:!0,validator:W}],birthdate:[{required:!0,validator:Z}],phone:[{required:!0,validator:B}],isMarry:[{required:!0,validator:ee}],isInsure:[{required:!0,validator:te}],addressSelected:[{required:!0,validator:P}],address:[{required:!0,validator:P}]};return(s,e)=>{const d=u("el-button"),m=u("Visitor"),c=u("el-card"),V=u("el-divider"),_=u("el-input"),n=u("el-form-item"),A=u("el-option"),D=u("el-select"),y=u("el-radio"),T=u("el-radio-group"),le=u("el-date-picker"),S=u("el-form"),ae=u("el-cascader");return p(),N(q,null,[r(f)==1?(p(),h(c,{key:0,style:{width:"100%"}},{header:l(()=>[w("div",be,[he,t(d,{type:"success",icon:r(me),onClick:Y},{default:l(()=>[i("添加就诊人")]),_:1},8,["icon"])])]),default:l(()=>[w("div",we,[(p(!0),N(q,null,E(r(C),(a,oe)=>(p(),h(m,{key:a.id,user:a,index:oe,class:"item",onChangeScene:z,onRemoveUser:H},null,8,["user","index"]))),128))])]),_:1})):O("",!0),r(f)==0?(p(),h(c,{key:1,style:{width:"100%"}},{header:l(()=>[ge]),default:l(()=>[t(V,{"content-position":"left"},{default:l(()=>[i("就诊人信息")]),_:1}),t(S,{style:{width:"60%",margin:"10px auto"},model:r(o),rules:k,ref_key:"forms",ref:M},{default:l(()=>[t(n,{label:"用户姓名",prop:"name"},{default:l(()=>[t(_,{placeholder:"请输入用户姓名",modelValue:r(o).name,"onUpdate:modelValue":e[0]||(e[0]=a=>r(o).name=a)},null,8,["modelValue"])]),_:1}),t(n,{label:"证件类型",prop:"certificatesType"},{default:l(()=>[t(D,{placeholder:"请选择证件类型",modelValue:r(o).certificatesType,"onUpdate:modelValue":e[1]||(e[1]=a=>r(o).certificatesType=a)},{default:l(()=>[(p(!0),N(q,null,E(r(x),a=>(p(),h(A,{key:a.id,label:a.name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"证件号码",prop:"certificatesNo"},{default:l(()=>[t(_,{placeholder:"请输入证件号码",modelValue:r(o).certificatesNo,"onUpdate:modelValue":e[2]||(e[2]=a=>r(o).certificatesNo=a)},null,8,["modelValue"])]),_:1}),t(n,{label:"用户性别",prop:"sex"},{default:l(()=>[t(T,{modelValue:r(o).sex,"onUpdate:modelValue":e[3]||(e[3]=a=>r(o).sex=a)},{default:l(()=>[t(y,{value:1},{default:l(()=>[i("男")]),_:1}),t(y,{value:0},{default:l(()=>[i("女")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"出生日期",prop:"birthdate"},{default:l(()=>[t(le,{modelValue:r(o).birthdate,"onUpdate:modelValue":e[4]||(e[4]=a=>r(o).birthdate=a),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetime",placeholder:"请选择用户出生日期"},null,8,["modelValue"])]),_:1}),t(n,{label:"手机号码",prop:"phone"},{default:l(()=>[t(_,{placeholder:"请输入用户手机号码",modelValue:r(o).phone,"onUpdate:modelValue":e[5]||(e[5]=a=>r(o).phone=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),t(V,{"content-position":"left"},{default:l(()=>[i("建档信息（完善后部分议医院首次就诊不排队建档）")]),_:1}),t(S,{style:{width:"60%",margin:"10px auto"},model:r(o),rules:k,ref_key:"form",ref:I},{default:l(()=>[t(n,{label:"婚姻状况",prop:"isMarry"},{default:l(()=>[t(T,{modelValue:r(o).isMarry,"onUpdate:modelValue":e[6]||(e[6]=a=>r(o).isMarry=a)},{default:l(()=>[t(y,{value:1},{default:l(()=>[i("未婚")]),_:1}),t(y,{value:0},{default:l(()=>[i("已婚")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"自费/医保",prop:"isInsure"},{default:l(()=>[t(T,{modelValue:r(o).isInsure,"onUpdate:modelValue":e[7]||(e[7]=a=>r(o).isInsure=a)},{default:l(()=>[t(y,{value:1},{default:l(()=>[i("自费")]),_:1}),t(y,{value:0},{default:l(()=>[i("医保")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"当前住址",prop:"addressSelected"},{default:l(()=>[t(ae,{props:X,modelValue:r(o).addressSelected,"onUpdate:modelValue":e[8]||(e[8]=a=>r(o).addressSelected=a)},null,8,["modelValue"])]),_:1}),t(n,{label:"详细地址",prop:"address"},{default:l(()=>[t(_,{placeholder:"请输入用户详细地址",modelValue:r(o).address,"onUpdate:modelValue":e[9]||(e[9]=a=>r(o).address=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),t(V,{"content-position":"left"},{default:l(()=>[i("联系人信息（选填）")]),_:1}),t(S,{style:{width:"60%",margin:"10px auto"},"label-width":"80"},{default:l(()=>[t(n,{label:"用户姓名"},{default:l(()=>[t(_,{placeholder:"请输入联系人姓名",modelValue:r(o).contactsName,"onUpdate:modelValue":e[10]||(e[10]=a=>r(o).contactsName=a)},null,8,["modelValue"])]),_:1}),t(n,{label:"证件类型"},{default:l(()=>[t(D,{placeholder:"请选择证件类型",modelValue:r(o).contactsCertificatesType,"onUpdate:modelValue":e[11]||(e[11]=a=>r(o).contactsCertificatesType=a)},{default:l(()=>[(p(!0),N(q,null,E(r(x),a=>(p(),h(A,{key:a.id,label:a.name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"证件号码"},{default:l(()=>[t(_,{placeholder:"请输入证件号码",modelValue:r(o).contactsCertificatesNo,"onUpdate:modelValue":e[12]||(e[12]=a=>r(o).contactsCertificatesNo=a)},null,8,["modelValue"])]),_:1}),t(n,{label:"手机号码"},{default:l(()=>[t(_,{placeholder:"请输入联系人手机号码",modelValue:r(o).contactsPhone,"onUpdate:modelValue":e[13]||(e[13]=a=>r(o).contactsPhone=a)},null,8,["modelValue"])]),_:1}),t(n,null,{default:l(()=>[t(d,{type:"primary",onClick:G},{default:l(()=>[i("提交")]),_:1}),t(d,{onClick:$},{default:l(()=>[i("重写")]),_:1})]),_:1})]),_:1})]),_:1})):O("",!0)],64)}}}),qe=Ve(Ce,[["__scopeId","data-v-7de02e40"]]);export{qe as default};
