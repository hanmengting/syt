import{h as Y,i as v,T as B,l as G,U as K,V as Q,o as _,c as S,w as e,a as i,g as n,e as l,j as a,W as Z,b,J as h,t as V,m as N,F as ee,d as te,k as le,N as x,X as ae,p as oe,f as se,_ as re}from"./index-L-QTi-72.js";const ie="/syt/assets/auth_example-DYDL_R-N.png",p=y=>(oe("data-v-3bb1458a"),y=y(),se(),y),ce=p(()=>n("div",{class:"card-header"},[n("span",null,"实名信息")],-1)),ne={class:"tip",style:{color:"#7f7f7f"}},de=p(()=>n("p",null,"完成实名认证后才能添加就诊人，正常进行挂号，为了不影响后续步骤，建议提前实名认证",-1)),ue={key:0,class:"success"},_e=p(()=>n("div",{class:"cell-item"}," 用户姓名 ",-1)),pe=p(()=>n("div",{class:"cell-item"}," 证件类型 ",-1)),fe=p(()=>n("div",{class:"cell-item"}," 证件号码 ",-1)),me={key:1,class:"failing"},ve=p(()=>n("img",{style:{width:"100%",height:"100%"},src:ie,alt:""},null,-1)),he=["src"],ye=Y({__name:"index",setup(y){let d=v(),T=v([]),o=B({certificatesNo:"",certificatesType:"",certificatesUrl:"",name:""}),f=v(!1),C=v(),w=v();G(()=>{I(),D()});const I=async()=>{let s=await K();s.code==200&&(d.value=s.data)},D=async()=>{let s=await Q();s.code==200&&(T.value=s.data)},F=()=>{x({type:"error",message:"最多只能上传一张图片"})},$=s=>{w.value.clearValidate("certificatesUrl"),o.certificatesUrl=s.data},A=()=>{f.value=!0},R=()=>{o.certificatesUrl=""},P=()=>{C.value.clearFiles(),Object.assign(o,{certificatesNo:"",certificatesType:"",certificatesUrl:"",name:""})},X=async()=>{await w.value.validate();try{await ae(o),x({type:"success",message:"认证成功"}),I()}catch{x({type:"error",message:"认证失败"})}},j={name:[{required:!0,validator:(s,t,r)=>{/^[\u4E00-\u9FA5]{2,10}(·[\u4E00-\u9FA5]{2,10}){0,2}$/.test(t)?r():r(new Error("请输入正确的名字格式"))}}],certificatesType:[{required:!0,validator:(s,t,r)=>{t=="10"||t=="20"?r():r(new Error("请选择证件类型"))}}],certificatesNo:[{required:!0,validator:(s,t,r)=>{let u=/^([1-6][1-9]|50)\d{4}(18|19|20)\d{2}((0[1-9])|10|11|12)(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,U=/^([1-6][1-9]|50)\d{4}\d{2}((0[1-9])|10|11|12)(([0-2][1-9])|10|20|30|31)\d{3}$/,g=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;u.test(t)||U.test(t)||g.test(t)?r():r(new Error("请输入正确的证件号码"))}}],certificatesUrl:[{required:!0,validator:(s,t,r)=>{t.length?r():r(new Error("请上传证件照图片"))}}]};return(s,t)=>{const r=i("el-icon"),u=i("el-descriptions-item"),U=i("el-descriptions"),g=i("el-input"),m=i("el-form-item"),z=i("el-option"),L=i("el-select"),M=i("el-upload"),H=i("el-dialog"),k=i("el-button"),J=i("el-form"),O=i("el-card");return _(),S(O,{class:"box-card"},{header:e(()=>[ce]),default:e(()=>{var E,q;return[n("div",ne,[l(r,null,{default:e(()=>[l(a(Z))]),_:1}),de]),((E=a(d))==null?void 0:E.authStatus)==1?(_(),b("div",ue,[l(U,{class:"margin-top",column:1,border:""},{default:e(()=>[l(u,{"label-align":"center",width:"40"},{label:e(()=>[_e]),default:e(()=>[h(" "+V(a(d).name),1)]),_:1}),l(u,{"label-align":"center",width:"40"},{label:e(()=>[pe]),default:e(()=>[h(" "+V(a(d).certificatesType=="10"?"身份证":"户口本"),1)]),_:1}),l(u,{"label-align":"center",width:"40"},{label:e(()=>[fe]),default:e(()=>[h(" "+V(a(d).certificatesNo),1)]),_:1})]),_:1})])):N("",!0),((q=a(d))==null?void 0:q.authStatus)==0?(_(),b("div",me,[l(J,{style:{width:"50%",margin:"20px auto"},"label-width":"80",model:a(o),rules:j,ref_key:"form",ref:w},{default:e(()=>[l(m,{label:"用户姓名",prop:"name"},{default:e(()=>[l(g,{placeholder:"请输入用户姓名",modelValue:a(o).name,"onUpdate:modelValue":t[0]||(t[0]=c=>a(o).name=c)},null,8,["modelValue"])]),_:1}),l(m,{label:"证件类型",prop:"certificatesType"},{default:e(()=>[l(L,{placeholder:"请选择证件类型",modelValue:a(o).certificatesType,"onUpdate:modelValue":t[1]||(t[1]=c=>a(o).certificatesType=c)},{default:e(()=>[(_(!0),b(ee,null,te(a(T),(c,W)=>(_(),S(z,{label:c.name,value:c.value,key:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"证件号码",prop:"certificatesNo"},{default:e(()=>[l(g,{placeholder:"请输入证件号码",modelValue:a(o).certificatesNo,"onUpdate:modelValue":t[2]||(t[2]=c=>a(o).certificatesNo=c)},null,8,["modelValue"])]),_:1}),l(m,{label:"上传证件",prop:"certificatesUrl"},{default:e(()=>[l(M,{"list-type":"picture-card",limit:1,"on-success":$,"on-exceed":F,"on-preview":A,"on-remove":R,ref_key:"upload",ref:C,action:"/api/oss/file/fileUpload?fileHost=userAuah"},{default:e(()=>[ve]),_:1},512),l(H,{modelValue:a(f),"onUpdate:modelValue":t[3]||(t[3]=c=>le(f)?f.value=c:f=c)},{default:e(()=>[a(o).certificatesUrl?(_(),b("img",{key:0,"w-full":"",style:{width:"100%",height:"100%"},src:a(o).certificatesUrl,alt:"Preview Image"},null,8,he)):N("",!0)]),_:1},8,["modelValue"])]),_:1}),l(m,null,{default:e(()=>[l(k,{type:"primary",size:"default",onClick:X},{default:e(()=>[h("提交")]),_:1}),l(k,{size:"default",onClick:P},{default:e(()=>[h("重写")]),_:1})]),_:1})]),_:1},8,["model"])])):N("",!0)]}),_:1})}}}),Ne=re(ye,[["__scopeId","data-v-3bb1458a"]]);export{Ne as default};
